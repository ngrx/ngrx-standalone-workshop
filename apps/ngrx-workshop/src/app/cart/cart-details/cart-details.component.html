@if (cartDetailsVm$ | async; as cartDetails) {
  @if (cartDetails.products; as cartProducts) {
    @if (cartProducts.length) {
      @for (product of cartProducts; track product) {
        <mat-card>
          <mat-card-content>
            <img [src]="product.url" />
            <div class="fill">
              <mat-card-title>{{ product.title }}</mat-card-title>
              <mat-card-subtitle
                >Quantity: {{ product.quantity }}</mat-card-subtitle
                >
              </div>
              <div class="details">
                <div>Price: {{ product.price | currency }}</div>
                <button mat-button (click)="removeOne(product.id)">Remove</button>
              </div>
            </mat-card-content>
          </mat-card>
        }
        <footer>
          <button type="button" mat-button (click)="removeAll()">
            Remove All
          </button>
          <div class="fill"></div>
          <button
            mat-raised-button
            color="primary"
            (click)="purchase(cartProducts)"
            >
            Purchase
          </button>
          <div class="total">Total: {{ cartDetails.total || 0 | currency }}</div>
        </footer>
      } @else {
        <div class="empty">No products here yet</div>
      }
    } @else {
      <mat-spinner class="loadingCart"></mat-spinner>
    }
  }

